<!DOCTYPE html> <!--TEST-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Italiana&display=swap" rel="stylesheet">
</head>
<body>

    <div style=" color: white;  width=200px; height: 100px;" class="wrapper">
        <script>
            let wrap =  document.getElementsByClassName('wrapper')[0];
          //console.log(wrap);
             let header = document.createElement("div");
             header.id = "header";
             
             console.log(header.innerHTML);
             wrap.appendChild(header);

           
            

            // nav ----------------------------------
             let nav = document.createElement('div');
             nav.id = 'nav';

             header.appendChild(nav);
             nav.innerHTML =  '<ul class="nav-menu"><li class="nav-item">Home</li><li class="nav-item">Categories</li></ul>';

             nav.style.cssText = 'background-color: black; display: flex;';
                //Shop ------------------------------------
             let shop = document.createElement('div')
             shop.className = 'shop';
             nav.appendChild(shop);
      
             shop.innerHTML = '<div class="shop-menu"></div>';
             const shopMenu = document.querySelector('.shop-menu');
            
             let table = document.createElement('table');

             let tHead = document.createElement('thead');
             let tr1 = document.createElement('tr'); 
             let th1 = document.createElement('th');
             let th2 = document.createElement('th');
             let th3 = document.createElement('th');

             let tBody = document.createElement('tbody');
            //  let tr2 = document.createElement('tr');
            //  let td1 = document.createElement('td');
            //  let td2 = document.createElement('td');
            //  let td3 = document.createElement('td');

            tHead.className = 't_head';
            tBody.className = 't_body';

             th1.className = 'th-1';
             th2.className = 'th-2';
             th3.className = 'th-3';


         




             shopMenu.appendChild(table);
            table.appendChild(tHead);
            tHead.appendChild(tr1);
            tr1.appendChild(th1);
            tr1.appendChild(th2);
            tr1.appendChild(th3);

            table.appendChild(tBody);
            // tBody.appendChild(tr2);
            // tr2.appendChild(td1);
            // tr2.appendChild(td2);
            // tr2.appendChild(td3);

            let orderButton = document.createElement('button');
            shopMenu.appendChild(orderButton);
            orderButton.className = "order_button"
            orderButton.innerText = 'Confirm order!'





            th1.innerText = "Book title";
            th2.innerText = "Uantity";
            th3.innerText = "Price";

            function addToShoppingCartDisplay(title, uantity, price){

                let tr2 = document.createElement('tr');
             let td1 = document.createElement('td');
             let td2 = document.createElement('td');
             let td3 = document.createElement('td');

             td1.className = 'td-1';
             td2.className = 'td-2';
             td3.className = 'td-3';

                tBody.appendChild(tr2);
             tr2.appendChild(td1);
             tr2.appendChild(td2);
            tr2.appendChild(td3);

              

                td1.innerText = title;
                td2.innerText = uantity;
                td3.innerText = price;
            }

            function refreshShoppingCart()
			{

             

                tBody.innerHTML = '';
				// do testowania
               // addToShoppingCartDisplay('lele', 3, 14);
               // addToShoppingCartDisplay('hh', 3, 14);

			console.log("Odswiezam koszyk");
			
              let cartItems = localStorage.getItem('productsInCart' );

              if (cartItems != null) {
					console.log("CartItems nie jest nullem");
			
				  cartItems = JSON.parse(cartItems);
					console.log("CartItems dlugosc to "+cartItems.length);
					console.log("CartItems to "+JSON.stringify(cartItems));
				  //for (let i = 0; i < cartItems.length; i++){	  
					//	let ksiazka = cartItems[i];
					for (var entry in cartItems) 
					{
						console.log("entry to "+JSON.stringify(entry));
						let ksiazka = cartItems[entry];
						//let ksiazka = entry.value;
					//	console.log("przetwrzam obiekt "+i);
						let tytul = ksiazka.title;
						console.log("jego tytul to "+tytul);
						let inCart = ksiazka.inCart;
						// na probe razy 100
						addToShoppingCartDisplay(tytul, inCart, inCart*100);
				  } 

            } else {
					console.log("CartItems  jest nullem");
                return;
            }
        }


            window.onload = refreshShoppingCart();
            refreshShoppingCart();
          





















            
             let shopItem = document.getElementById('.shop-item');
             shopItem = String(shopItem);
             console.log(shopItem);
             shopItem.innerHTML = 'blabla';
             
             
             let bar4 = document.createElement('span');
           // let bar5 = document.createElement('span');
           // let bar6 = document.createElement('span');
            bar4.className = 'bars';;
            bar4.innerHTML = '<img style="heigth=50px; width: 50px;" src="../img/store.svg">';
           // bar5.className = 'bars';
           // bar6.className = 'bars';
            shop.appendChild(bar4);
           // shop.appendChild(bar5);
            //shop.appendChild(bar6);

            let shopNumber = document.createElement('pre');
            shopNumber.textContent = 0;
            shopNumber.style.cssText = "color: yellow";



            shop.appendChild(shopNumber);
           // shopNumber = parseInt(shopNumber);
           // console.log(typeof shopNumber);

           

            shop.addEventListener("click", () =>{
                shop.classList.toggle("active");
                shopMenu.classList.toggle("active");
            })

                //Menu ------------------------------------

             let hamburger = document.createElement('div');
             hamburger.className = 'hamburger';
             nav.appendChild(hamburger);



            
            let bar1 = document.createElement('span');
            let bar2 = document.createElement('span');
            let bar3 = document.createElement('span');
            bar1.className = 'bar';
            bar2.className = 'bar';
            bar3.className = 'bar';
            hamburger.appendChild(bar1);
            hamburger.appendChild(bar2);
            hamburger.appendChild(bar3);
             

            const navMenu = document.querySelector('.nav-menu');

            hamburger.addEventListener("click", () =>{
                hamburger.classList.toggle("active");
                navMenu.classList.toggle("active");
            });
    //main ---------------------------------------

    let main = document.createElement('div');
    main.id = 'main';
    wrap.appendChild(main);
            
    main.style.cssText = 'height: 800px; background-color: blue;'

        //articleOne ------------------------------------

        let articleOne = document.createElement('div');
        articleOne.id = 'article_one';
        main.appendChild(articleOne);
        articleOne.style.cssText = "background-image: url('../img/books-g26621cdd7_1920.jpg');  height: 850px;";
     
            //h1 -------------------------------------------

            let newh1 = document.createElement('h1');
            article_one.appendChild(newh1);
            newh1.innerHTML = 'GEEK<br/>&nbspBOOK';
            newh1.style.cssText = "padding: 57px; top: 176px; left:308px; right: 160px; font-weight: 400; font-family: 'Italiana', serif; color: black; font-size: 200px;  margin:0; " ;
     
    



        //articleTwo ----------------------------------------
        let articleTwo = document.createElement('div');
        articleTwo.id = 'article_two';
        main.appendChild(articleTwo);
        articleTwo.style.cssText = " background-color: #37302D; /*background-color: rgb(255 250 239);*/ height: 3323px;" ;
     

            //sectionOne ---------------------------------
            let sectionOne = document.createElement('div');
            sectionOne.id = 'sectionOne';
            articleTwo.appendChild(sectionOne);

           // let line = document.createElement('span');
          
         //  line.className = 'line-img';
         //   line.src = '<img  src="../img/line.svg">'
         //   line.innerHTML = '<img  src="../img/line.svg">';
          //  sectionOne.appendChild(line);
            



            function changeJson (myJson) {

                for(let i = 0; i < myJson.length; i++) {

                    let img = document.createElement('img');
                    img.src = myJson[i].imageLink;
                    let title = document.createElement('p');
                    title.id = 'title';
              
                    let name = myJson[i].author;
                    title = myJson[i].title;

                    let price = document.createElement('p');
                    price.id = 'price';
                    price = myJson[i].price;

                    let newNode = document.createElement('div');
                    newNode.id = 'books';
                    

                    //buy -------------------------------------

                    let buyButton = document.createElement('button');
                    buyButton.id = 'buyButton';
                    buyButton.className = 'buy_button';
                    buyButton.innerText = "BUY";
                    newNode.appendChild(buyButton);


                

                    buyButton.addEventListener('click',  () => {
                        buyNumbers(myJson[i]);
                        totalCost(myJson[i]);
                    });

                    function buyNumbers(myJson) {
                        let productNumbers = localStorage.getItem('buyNumbers');
                       

                        productNumbers = parseInt(productNumbers);
                        if(productNumbers) {
                            localStorage.setItem('buyNumbers', productNumbers + 1);
                            document.querySelector('.shop pre').textContent = productNumbers + 1;
                        } else {
                            localStorage.setItem('buyNumbers',  1);
                            document.querySelector('.shop pre').textContent = 1;

                        }

                        setItems(myJson);
                        function setItems(myJson){
                            let cartItems = localStorage.getItem('productsInCart' );
                            cartItems = JSON.parse(cartItems);
                           // console.log('My cartItems are', cartItems);


                            // czy koszyk istnieje?
                            if(cartItems != null) {
                                // czy dany tytul jest juz w koszyku?
                                if(cartItems[myJson.title]!=null){
                                    // zwieksz mu ilosc o 1
                                    cartItems[myJson.title].inCart += 1;
                                }
                                else{
                                    // wsadz do koszyka ten tytul z iloscia 1 

                                    cartItems[myJson.title] = myJson;
                                    cartItems[myJson.title].inCart = 1;


                                }

                            }else {
                                // utworz koszyk pierwszy raz
                                myJson.inCart = 1;

                                cartItems = {
                                    [myJson.title]: myJson 
                                }
                          
                            }
                            localStorage.setItem("productsInCart", JSON.stringify(cartItems)); //JSON.stringify - awesome!
							refreshShoppingCart();
                        }

                    }


                    function onLoadCartNumbers() {
                        let productNumbers = localStorage.getItem('buyNumbers');

                        if(productNumbers){
                            document.querySelector('.shop pre').innerText = productNumbers;
                        }

                    }
                    onLoadCartNumbers()

                    function totalCost(myJson) {
                        let cartCost = localStorage.getItem('totalCost');
                        
                        console.log('My cartCost is', cartCost);
                        console.log(typeof cartCost);


                        if(cartCost != null) {
                            
                            cartCost = parseInt(cartCost); //its always a string
                            cartCost = Number(cartCost);

                            localStorage.setItem('totalCost', cartCost + myJson.price);

                        }else {
                            cartCost = parseInt(cartCost); //its always a string
                            cartCost = Number(cartCost);

                            localStorage.setItem('totalCost', myJson.price);


                        }
                        refreshShoppingCart();

                       
                    }
                    ////----mój własny kod
                  //function bascet() {
                     // let replaceBascet = 'LALALAL';
                   //   tryl = replaceBascet;
                      // replaceBascet.innerHTML =  'LALALAL' //totalCost(myJson);
                   
                   //}
                 // bascet();




                    
                    //showMore -------------------------------
                    let showMore = document.createElement('button');
                    showMore.id = 'button';
                    showMore.className = 'showMore';
                    showMore.innerText = "Show more...";

                



             let bar7 = document.createElement('span');
            let bar8= document.createElement('span');
            let bar9 = document.createElement('span');
           // bar7.className = 'bar';
          //  bar8.className = 'bar';
           // bar9.className = 'bar';
           // showMore.appendChild(bar7);
           // showMore.appendChild(bar8);
            //showMore.appendChild(bar9);  
           
           const tryl = document.createElement('div');
            tryl.id = 'try'

            tryl.innerHTML = 
'<ul class="show-menu"><li class="shop-item">Home</li><li class="shop-item">Categories</li></ul>';

           


            showMore.addEventListener("click", () =>{
                showMore.classList.toggle("active");
                showMenu.classList.toggle("active");
            })
                   


                   // newNode.innerHTML =  name + '<br/>'  + title + '<br/>' ;
                    newNode.appendChild(img);


                    
                    newNode.appendChild(document.createElement('br'));

                    let myPrice = document.createElement('b');
                    myPrice.innerText = price + '$';
                    newNode.appendChild(myPrice);
                    myPrice.className = 'my-price';


                    let myName = document.createElement('h2');
                    myName.innerText = name;
                    newNode.appendChild(myName);

                  

                    let myTitle = document.createElement('p');
                    myTitle.innerText = title;
                    newNode.appendChild(myTitle);



                    sectionOne.appendChild(newNode);
                    
                    newNode.appendChild(showMore);
                   
                    img.style.cssText = "border: 5px solid rgb(31 140 171); align-self: center; text-align: center; height: 363px; width: 191px;"
                   
                    newNode.style.cssText = "height: 367px; justify-content: space-between;  width: 55%; display: flex; flex-direction: column; text-align: left;  font-size: 16px;"
                  


                
                  

                }

            }
           // let btn = document.getElementById('button')
       





            fetch('books.json') //path to the file with json data
            .then(response => {
                return response.json();
            })
            .then(data => {
                changeJson(data);
            });
           

          





              
         </script>
    </div>
</body>
</html>